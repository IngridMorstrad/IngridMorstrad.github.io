<!DOCTYPE html>
<html lang="">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title> Optimizing Outlook | </title>
  <meta name="description" content="Hi, I&#39;m Ashwin. This is my little corner of the web. Hope you enjoy your stay. Feel free to leave a comment or tweet.">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="robots" content="all,follow">
  <meta name="googlebot" content="index,follow,snippet,archive">
  <meta property="og:title" content="Optimizing Outlook" />
<meta property="og:description" content="Introduction They say &ldquo;necessity is the mother of invention&rdquo;. It&rsquo;s incredible the power programming gives you. Maybe if the power-hungry learned how to program they could be constructive rather than destructive. Then again, the recent Facebook scandal makes you wonder.
The problem Stepping down a few rungs and we&rsquo;re back to the little world I live in. For the past few days/weeks, I had been frustrated by the lack of mailbox space at work." />
<meta property="og:type" content="article" />
<meta property="og:url" content="/posts/activities/2018-04-11-optimizing-outlook/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2018-04-11T19:29:00+00:00" />
<meta property="article:modified_time" content="2018-04-11T19:29:00+00:00" />


  <meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Optimizing Outlook"/>
<meta name="twitter:description" content="Introduction They say &ldquo;necessity is the mother of invention&rdquo;. It&rsquo;s incredible the power programming gives you. Maybe if the power-hungry learned how to program they could be constructive rather than destructive. Then again, the recent Facebook scandal makes you wonder.
The problem Stepping down a few rungs and we&rsquo;re back to the little world I live in. For the past few days/weeks, I had been frustrated by the lack of mailbox space at work."/>

  
  
  
  <link rel="stylesheet" href="/css/style-white.css">
  
  
  
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
  

  
<link rel="icon" type="image/png" href="images/favicon.ico" />

  
  
  
  
  
    
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
	ga('create', 'UA-75060729-1', 'auto');
	
	ga('send', 'pageview');
}
</script>
  
  
</head>

<body class="max-width mx-auto px3 ltr">
  <div class="content index py4">

  <div id="header-post">
  <a id="menu-icon" href="#"><i class="fas fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#"><i class="fas fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fas fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
         
        <li><a href="/">Home</a></li>
         
        <li><a href="/posts">All posts</a></li>
         
        <li><a href="/tags">Tags</a></li>
        
      </ul>
    </span>
    <br/>
    <span id="actions">
      <ul>
        
        <li>
          <a class="icon" href=" /posts/activities/2018-03-12-a-rating-system-for-table-tennis/">
            <i class="fas fa-chevron-left" aria-hidden="true" onmouseover="$('#i-prev').toggle();" onmouseout="$('#i-prev').toggle();"></i>
          </a>
        </li>
        
        
        <li>
          <a class="icon" href="/posts/activities/2018-09-18-a-guide-to-charity/">
            <i class="fas fa-chevron-right" aria-hidden="true" onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i>
          </a>
        </li>
        
        <li>
          <a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');">
            <i class="fas fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i>
          </a>
        </li>
        <li>
          <a class="icon" href="#">
            <i class="fas fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i>
          </a>
        </li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">Previous post</span>
      <span id="i-next" class="info" style="display:none;">Next post</span>
      <span id="i-top" class="info" style="display:none;">Back to top</span>
      <span id="i-share" class="info" style="display:none;">Share post</span>
    </span>
    <br/>
    <div id="share" style="display: none">
      
      <ul>
  
  
    
  
  
  <li>
    <a class="icon" href="http://www.facebook.com/sharer.php?u=%2fposts%2factivities%2f2018-04-11-optimizing-outlook%2f">
      <i class="fab fa-facebook " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://twitter.com/share?url=%2fposts%2factivities%2f2018-04-11-optimizing-outlook%2f&text=Optimizing%20Outlook">
      <i class="fab fa-twitter " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="http://www.linkedin.com/shareArticle?url=%2fposts%2factivities%2f2018-04-11-optimizing-outlook%2f&title=Optimizing%20Outlook">
      <i class="fab fa-linkedin " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=%2fposts%2factivities%2f2018-04-11-optimizing-outlook%2f&is_video=false&description=Optimizing%20Outlook">
      <i class="fab fa-pinterest " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="mailto:?subject=Optimizing%20Outlook&body=Check out this article: %2fposts%2factivities%2f2018-04-11-optimizing-outlook%2f">
      <i class="fas fa-envelope " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://getpocket.com/save?url=%2fposts%2factivities%2f2018-04-11-optimizing-outlook%2f&title=Optimizing%20Outlook">
      <i class="fab fa-get-pocket " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="http://reddit.com/submit?url=%2fposts%2factivities%2f2018-04-11-optimizing-outlook%2f&title=Optimizing%20Outlook">
      <i class="fab fa-reddit " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="http://www.stumbleupon.com/submit?url=%2fposts%2factivities%2f2018-04-11-optimizing-outlook%2f&title=Optimizing%20Outlook">
      <i class="fab fa-stumbleupon " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="http://digg.com/submit?url=%2fposts%2factivities%2f2018-04-11-optimizing-outlook%2f&title=Optimizing%20Outlook">
      <i class="fab fa-digg " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="http://www.tumblr.com/share/link?url=%2fposts%2factivities%2f2018-04-11-optimizing-outlook%2f&name=Optimizing%20Outlook&description=Introduction%20They%20say%20%26ldquo%3bnecessity%20is%20the%20mother%20of%20invention%26rdquo%3b.%20It%26rsquo%3bs%20incredible%20the%20power%20programming%20gives%20you.%20Maybe%20if%20the%20power-hungry%20learned%20how%20to%20program%20they%20could%20be%20constructive%20rather%20than%20destructive.%20Then%20again%2c%20the%20recent%20Facebook%20scandal%20makes%20you%20wonder.%0aThe%20problem%20Stepping%20down%20a%20few%20rungs%20and%20we%26rsquo%3bre%20back%20to%20the%20little%20world%20I%20live%20in.%20For%20the%20past%20few%20days%2fweeks%2c%20I%20had%20been%20frustrated%20by%20the%20lack%20of%20mailbox%20space%20at%20work.">
      <i class="fab fa-tumblr " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://news.ycombinator.com/submitlink?u=%2fposts%2factivities%2f2018-04-11-optimizing-outlook%2f&t=Optimizing%20Outlook">
      <i class="fab fa-hacker-news " aria-hidden="true"></i>
    </a>
  </li>
</ul>

    </div>
    <div id="toc">
      <nav id="TableOfContents">
  <ul>
    <li><a href="#introduction">Introduction</a></li>
    <li><a href="#the-problem">The problem</a></li>
    <li><a href="#the-solution">The solution</a>
      <ul>
        <li><a href="#tools">Tools</a></li>
        <li><a href="#the-logic">The logic</a></li>
        <li><a href="#issues-that-come-up-while-working-on-the-problem">Issues that come up while working on the problem</a></li>
      </ul>
    </li>
    <li><a href="#conclusion">Conclusion</a>
      <ul>
        <li></li>
      </ul>
    </li>
  </ul>
</nav>
    </div>
  </span>
</div>


  <article class="post" itemscope itemtype="http://schema.org/BlogPosting">
    <header>
      <h1 class="posttitle" itemprop="name headline">
        Optimizing Outlook
      </h1>
      <div class="meta">
        
        <div class="postdate">
          
          <time datetime="2018-04-11 19:29:00 &#43;0000 UTC" itemprop="datePublished">2018-04-11</time>
          
        </div>
        
        
      </div>
    </header>

  
    <div class="content" itemprop="articleBody">
      <h2 id="introduction">Introduction</h2>
<p>They say &ldquo;necessity is the mother of invention&rdquo;. It&rsquo;s incredible the power programming gives you. Maybe if the power-hungry learned how to program they could be constructive rather than destructive. Then again, the recent Facebook scandal makes you wonder.</p>
<h2 id="the-problem">The problem</h2>
<p>Stepping down a few rungs and we&rsquo;re back to the little world I live in. For the past few days/weeks, I had been frustrated by the lack of mailbox space at work. 2 GB. &ldquo;But, mail providers give you 15 GB for personal email nowadays!&rdquo; I hear you say.</p>
<!-- raw HTML omitted -->
<p>Now, Outlook for Windows had this feature where you could group messages by conversations and then get rid of redundant messages in those conversations. What is a conversation? I&rsquo;m not 100% certain, but I think it works like this:</p>
<p>Let&rsquo;s say you send a message. Now, any message that is a reply to that message (or possibly even a forwarded version of that message) is part of the conversation. Any reply (or possibly even forward) of a message in the conversation is also in the conversation. Ooh, closures. Or a recurrence? Different from recursion, I believe. Terms are well and good but as long you understand it, it doesn&rsquo;t matter.</p>
<p>This concept (of a conversation) let&rsquo;s you optimize messages. For example, when you send a message, and someone replies to that message, in most cases the entire text of your message is included in their message. That means your message provides no additional information and can be thrown in the trash. This can be done for every message in the conversation and you can get significant reductions in storage (up to reducing an entire conversation to just one - the final - message).</p>
<h2 id="the-solution">The solution</h2>
<p>Of course, this is easier said than done, and that is where this becomes an engineering problem. There are many parts of the problem to think about:</p>
<h3 id="tools">Tools</h3>
<p>You clearly do want to have some kind of programmatic way to access (read &amp; delete) messages. Outlook for Windows has VBA scripts. On Mac? After some Googling, I discovered that you can use AppleScript, a scripting language for Mac which lets you interact with any other application on the Mac. Pretty cool!</p>
<p>This meant learning enough of a new language to write the program. AppleScript is probably the most readable language I&rsquo;ve found yet. It reads like English. After coding in other languages, it took a little getting used to. The Script Editor (an application that comes with Mac) also has a Dictionary for every application it can interact with. For this task, I had to read the Microsoft Outlook dictionary, which explains what concepts exist (and can be interacted with programmatically) in Microsoft Outlook. Examples of these concepts include messages &amp; folders.</p>
<p>AppleScript is very &ldquo;primitive&rdquo; in a sense. There are very few features/functions provided, and I had to Google extensively to see if there were implementations of common functions I could re-use. Re-use plays a big role in engineering. Why reuse? What about the purity of writing something from your own intellect? Well, that would slow things down and could produce bugs. It also lets you scale &amp; build bigger &amp; better things. Delivery is the other big part of engineering.</p>
<h3 id="the-logic">The logic</h3>
<p>The logic was not very easy to pin down. It would have been a lot easier if Outlook let you iterate through conversations and iterate through messages in conversation order (as in the UI). That&rsquo;s the initial assumption I made and started with. Assumptions are important in engineering too. It&rsquo;s important to get them right, or to get them reasonably right. If this assumption was wrong, I could still re-use the rest of what I&rsquo;d done. At this point, this was the logic I had:</p>
<pre><code>Algorithm 1

For each conversation
    Set allContent to &lt;blank&gt;
    For each message in conversation (from newest to oldest)
        If message's content is in allContent, delete message
        Else add message's content to allContent
</code></pre>
<p>Unfortunately, I later learned that it just gives you a list of messages in a folder in what seemed like mostly random order. This means you need to sort the messages in some order. I went with &ldquo;Time sent&rdquo;. Note, however, that you still don&rsquo;t have the messages by conversation. Two messages in the same conversation could be separated by many others if you sort all messages by time sent. Ideally, you would want to partition the list of messages by conversation, and then just iterate through each partition, deleting the redundant messages. I opted for a much more inefficient, but easier to code solution (considering the difficulties of dealing with Outlook&rsquo;s objects in AppleScript). The logic looks something like this:</p>
<pre><code>Algorithm 2

For every message in the folder
    Run Algorithm 1 on [all messages in the folder with the same subject]
</code></pre>
<p>Technically, you have to look for a similar subject (due to replies that start with &ldquo;Re: &quot; for example). If there are N messages in the folder, this is clearly O(N^2), whereas the partition algorithm would be O(N).</p>
<h3 id="issues-that-come-up-while-working-on-the-problem">Issues that come up while working on the problem</h3>
<h4 id="aka-runtime-issues-huehuehue">AKA Runtime issues (huehuehue)</h4>
<p>AppleScript threw up a lot of problems as it is has very few &ldquo;features&rdquo;. I struggled with getting the function to recognize types (from the Outlook dictionary), and it took hours of Googling to get to the solution.</p>
<p>Messages were never found to be exact subsets of other messages. After investigating, I found out that this was because of newlines and spaces. To get around this, I deleted all newlines and spaces. It would have been more efficient (theoretically at least) to write a new &ldquo;contains substring&rdquo; function that ignores newlines and spaces. However, since AppleScript has decent support for deleting newlines/spaces &amp; a contains function, and previously mentioned advantages of &ldquo;re-use&rdquo;, I decided to ditch the optimization (for the first iteration at least).</p>
<p>Since, as mentioned above in point 2, we have to figure out which messages belong to the same conversation. Initially, after figuring out all the messages to be deleted, I was deleting all of them at the end. This ended up being slow as I was iterating through all messages, even after I knew they had to be deleted. Storing all messages to be deleted, taking up memory, may not have helped either (I&rsquo;m uncertain about this - maybe only a pointer is stored). I tried deleting messages immediately, but that wouldn&rsquo;t work because it interfered with the iteration and threw up errors. Finally, I decided to exit the loops after finding messages to be deleted, delete the messages, build up the list of messages again (which should decrease each time) and loop again. This turned out to be unbearably slow (Why? left as an exercise to the reader. Answer at the bottom.), even though I thought for certain it could run faster. This took over 3 hours to go over a folder with ~5000 messages (don&rsquo;t have data on the number of repeated messages). To fix this, I decided to &ldquo;batch&rdquo; the deletes. The deletes would exit the loops only after a certain number of conversations had been found to have repeated messages. This now runs fairly quickly.</p>
<h2 id="conclusion">Conclusion</h2>
<p>Overall, this was a very fun and fulfilling exercise. I ended up reducing my mailbox space significantly (700 MB to 100 MB for one folder alone). The code is <a href="https://github.com/IngridMorstrad/Scripts/blob/master/OptimizeOutlook.applescript">on Github</a>.</p>
<h4 id="answer-to-exercise-above">Answer to exercise above</h4>
<p>This was slow as each time you deleted messages from a conversation, you would then start at the very beginning and loop over all messages, even the ones you knew should NOT be deleted. In some ways, the exact opposite of the problem we started with.</p>

    </div>
  </article>

  
  





  <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/posts">All posts</a></li>
         
          <li><a href="/tags">Tags</a></li>
        
      </ul>
    </div>

    <div id="toc-footer" style="display: none">
      <nav id="TableOfContents">
  <ul>
    <li><a href="#introduction">Introduction</a></li>
    <li><a href="#the-problem">The problem</a></li>
    <li><a href="#the-solution">The solution</a>
      <ul>
        <li><a href="#tools">Tools</a></li>
        <li><a href="#the-logic">The logic</a></li>
        <li><a href="#issues-that-come-up-while-working-on-the-problem">Issues that come up while working on the problem</a></li>
      </ul>
    </li>
    <li><a href="#conclusion">Conclusion</a>
      <ul>
        <li></li>
      </ul>
    </li>
  </ul>
</nav>
    </div>

    <div id="share-footer" style="display: none">
      
      <ul>
  
  
    
  
  
  <li>
    <a class="icon" href="http://www.facebook.com/sharer.php?u=%2fposts%2factivities%2f2018-04-11-optimizing-outlook%2f">
      <i class="fab fa-facebook fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://twitter.com/share?url=%2fposts%2factivities%2f2018-04-11-optimizing-outlook%2f&text=Optimizing%20Outlook">
      <i class="fab fa-twitter fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="http://www.linkedin.com/shareArticle?url=%2fposts%2factivities%2f2018-04-11-optimizing-outlook%2f&title=Optimizing%20Outlook">
      <i class="fab fa-linkedin fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=%2fposts%2factivities%2f2018-04-11-optimizing-outlook%2f&is_video=false&description=Optimizing%20Outlook">
      <i class="fab fa-pinterest fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="mailto:?subject=Optimizing%20Outlook&body=Check out this article: %2fposts%2factivities%2f2018-04-11-optimizing-outlook%2f">
      <i class="fas fa-envelope fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://getpocket.com/save?url=%2fposts%2factivities%2f2018-04-11-optimizing-outlook%2f&title=Optimizing%20Outlook">
      <i class="fab fa-get-pocket fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="http://reddit.com/submit?url=%2fposts%2factivities%2f2018-04-11-optimizing-outlook%2f&title=Optimizing%20Outlook">
      <i class="fab fa-reddit fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="http://www.stumbleupon.com/submit?url=%2fposts%2factivities%2f2018-04-11-optimizing-outlook%2f&title=Optimizing%20Outlook">
      <i class="fab fa-stumbleupon fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="http://digg.com/submit?url=%2fposts%2factivities%2f2018-04-11-optimizing-outlook%2f&title=Optimizing%20Outlook">
      <i class="fab fa-digg fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="http://www.tumblr.com/share/link?url=%2fposts%2factivities%2f2018-04-11-optimizing-outlook%2f&name=Optimizing%20Outlook&description=Introduction%20They%20say%20%26ldquo%3bnecessity%20is%20the%20mother%20of%20invention%26rdquo%3b.%20It%26rsquo%3bs%20incredible%20the%20power%20programming%20gives%20you.%20Maybe%20if%20the%20power-hungry%20learned%20how%20to%20program%20they%20could%20be%20constructive%20rather%20than%20destructive.%20Then%20again%2c%20the%20recent%20Facebook%20scandal%20makes%20you%20wonder.%0aThe%20problem%20Stepping%20down%20a%20few%20rungs%20and%20we%26rsquo%3bre%20back%20to%20the%20little%20world%20I%20live%20in.%20For%20the%20past%20few%20days%2fweeks%2c%20I%20had%20been%20frustrated%20by%20the%20lack%20of%20mailbox%20space%20at%20work.">
      <i class="fab fa-tumblr fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://news.ycombinator.com/submitlink?u=%2fposts%2factivities%2f2018-04-11-optimizing-outlook%2f&t=Optimizing%20Outlook">
      <i class="fab fa-hacker-news fa-lg" aria-hidden="true"></i>
    </a>
  </li>
</ul>

    </div>

    <div id="actions-footer">
      
        <a id="menu" class="icon" href="#" onclick="$('#nav-footer').toggle();return false;">
          <i class="fas fa-bars fa-lg" aria-hidden="true"></i> Menu</a>
        <a id="toc" class="icon" href="#" onclick="$('#toc-footer').toggle();return false;">
          <i class="fas fa-list fa-lg" aria-hidden="true"></i> TOC</a>
        <a id="share" class="icon" href="#" onclick="$('#share-footer').toggle();return false;">
          <i class="fas fa-share-alt fa-lg" aria-hidden="true"></i> share</a>
        <a id="top" style="display:none" class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');">
          <i class="fas fa-chevron-up fa-lg" aria-hidden="true"></i> Top</a>
    </div>

  </div>
</div>


  <footer id="footer">
  <div class="footer-left">
    Copyright  &copy; 2021   
  </div>
  <div class="footer-right">
    <nav>
      <ul>
         
        <li><a href="/">Home</a></li>
         
        <li><a href="/posts">All posts</a></li>
         
        <li><a href="/tags">Tags</a></li>
        
      </ul>
    </nav>
  </div>
</footer>


  </div>
</body>

<link rel="stylesheet" href=/lib/font-awesome/css/all.min.css>
<script src=/lib/jquery/jquery.min.js></script>
<script src=/js/main.js></script>



</html>
